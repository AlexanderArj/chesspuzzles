(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&s(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}})();class j{constructor(t,n){this.boardContainer=n,this.squares=t}init(){this.buildBoard(this.squares,this.boardContainer)}buildBoard(t,n){t.forEach(s=>{const o=document.createElement("div");o.classList.add("square",s.colorCode),o.dataset.square=s.square,n.appendChild(o)})}}const L="/json/board.json",T="/json/pieces.json",$="https://lichess.org/api/puzzle/daily",M="https://lichess.org/api/puzzle/next?angle=&difficulty=easiest&color=white";async function k(){return await(await fetch(L)).json()}async function v(){return await(await fetch(T)).json()}async function x(){try{const e=await fetch($);if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);return await e.json()}catch(e){return console.error("There was an error loading the daily puzzle:",e),null}}async function A(){try{const e=await fetch(M);if(!e.ok)throw new Error(`Error HTTP: ${e.status}`);return await e.json()}catch(e){return console.error("There was an error loading the puzzle:",e),null}}class D{constructor(t,n){this.piece=t,this.mainCointainer=n}create(t,n){const s=document.createElement("div");s.classList.add("piece",`${t.color}${t.category}`);const o=document.createElement("img");o.setAttribute("src",t.image),o.setAttribute("alt",`${t.color} ${t.category} icon`),s.dataset.id=this.piece.pId,s.style.transform="translate(0px, 0px)",s.appendChild(o),n.appendChild(s)}}const S=await v(),O=document.getElementById("chess-board");async function R(){S.forEach(e=>{new D(e).create(e,O)})}function z(e,t,n){const[s,o]=t,a=document.querySelector(`[data-id="${e.pId}"]`);e.file=s,e.rank=o;const c=s*n,m=o*n;a.style.transform=`translate(${c}px, ${m}px)`}function J(e,t){e.forEach(n=>{const s=n.file,o=n.rank;z(n,[s,o],t)})}const N="./json/testJson1.json";async function H(){return await(await fetch(N)).json()}function U(e){return e.game.split(" ")}function F(e,t){e.removeChild(t),console.log("A piece has been deleted")}async function K(){const e=document.getElementById("chess-board"),t=await k();let n=await v();const s=e.clientWidth/8;new j(t,e).init(),await R(),J(n,s);const a=await H(),c=await x();console.log(c);const m=await A();console.log(m);const p=U(a);function E(i){return{piece:i.slice(0,2),destinationSquare:i.slice(2,4)}}function b(i){return new Promise(l=>setTimeout(l,i))}async function q(){for(let i=0;i<p.length;i++){const l=E(p[i]),C=l.piece,B=l.destinationSquare,h=t.find(r=>C===r.square),d=t.find(r=>B===r.square),g=n.find(r=>r.file===h.file&&r.rank===h.rank);let u=n.find(r=>r.file===d.file&&r.rank===d.rank&&r.color!=g.color);if(u){let r=document.querySelector(`[data-id="${u.pId}"]`);n=n.filter(I=>I.pId!==u.pId),F(e,r)}else u=null;z(g,[d.file,d.rank],s),i===p.length-1&&(document.getElementById("move-notation").textContent="Checkmate!"),await b(2e3)}}q()}const f=document.getElementById("audio"),W=document.getElementById("volumeBtn"),w=document.getElementById("volumeIcon"),P=document.getElementById("startModal"),X=document.getElementById("startButton");let y=!1;const G=.2;X.addEventListener("click",()=>{f.volume=G,f.play(),P.classList.add("fade-out"),setTimeout(()=>{P.style.display="none"},800),K(),W.addEventListener("click",()=>{y?(f.muted=!1,y=!1,w.src="images/volume.svg"):(f.muted=!0,y=!0,w.src="images/volume-mute.svg")})});
